{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2 class="mb-4">Attendance Report</h2>

  <form method="get"
    style="display: flex; flex-wrap: wrap; gap: 1rem; align-items: flex-end; margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border-color);">
    <div style="flex: 1; min-width: 150px;">
      <label>Period</label>
      <select name="period">
        <option value="daily" {{ 'selected' if period=='daily' else '' }}>Daily</option>
        <option value="weekly" {{ 'selected' if period=='weekly' else '' }}>Weekly</option>
        <option value="monthly" {{ 'selected' if period=='monthly' else '' }}>Monthly</option>
        <option value="custom" {{ 'selected' if period=='custom' else '' }}>Custom</option>
      </select>
    </div>

    <div style="flex: 1; min-width: 150px;">
      <label>Date (Reference)</label>
      <input type="date" name="date">
    </div>

    <div style="flex: 1; min-width: 150px;">
      <label>Start Date</label>
      <input type="date" name="start_date">
    </div>

    <div style="flex: 1; min-width: 150px;">
      <label>End Date</label>
      <input type="date" name="end_date">
    </div>

    <div style="flex: 0 0 auto;">
      <button type="submit" class="btn">Show Report</button>
    </div>
  </form>

  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
    <div>
      <h3>From {{ start_date }} to {{ end_date }}</h3>
      <p style="color: var(--text-light);">Total wages: <strong
          style="color: var(--success-color); font-size: 1.25rem;">{{ "%.2f"|format(total_wages) }}</strong></p>
    </div>
    <button onclick="window.print()" class="btn btn-secondary">Print Report</button>
  </div>

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Labor</th>
          <th>Type</th>
          <th>Wage</th>
          <th>Hours</th>
          <th>Tasks</th>
        </tr>
      </thead>
      <tbody>
        {% for attendance, labor in records %}
        <tr>
          <td>{{ attendance.work_date }}</td>
          <td>{{ labor.name }}</td>
          <td>
            <span
              style="text-transform: capitalize; padding: 0.25rem 0.5rem; background: #e2e8f0; border-radius: 4px; font-size: 0.875rem;">
              {{ attendance.labor_type }}
            </span>
          </td>
          <td style="font-weight: 600;">{{ "%.2f"|format(attendance.wage_amount) }}</td>
          <td>{{ attendance.hours_worked or '-' }}</td>
          <td>{{ attendance.tasks_done or '-' }}</td>
        </tr>
        {% else %}
        <tr>
          <td colspan="6" class="text-center">No records found for this period.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}